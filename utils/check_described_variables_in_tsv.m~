function  non_described_vars = check_described_variables_in_tsv(bids_dir,cfg_struct,sub_input,tsv_file)
%UNTITLED4 Summary of this function goes here
%   Detailed explanation goes here

if ~isstruct(sub_input)
    ses = {'one_ses'};
    sub.(ses{1}) = sub_input;
elseif isstruct(sub_input)
    sub = sub_input;
    ses = fieldnames(sub);
end

file_struct = dir(sprintf('%s/**/*%s',bids_dir,tsv_file));
folders={file_struct.folder};
tsv_names={file_struct.name};
multiple_tsv_paths = fullfile(folders,tsv_names);   

for jj = 1:length(ses)
    for ii = 1:length(sub.(ses{jj}))
    
        described_vars=fieldnames(cfg_struct);
        
        sub_tsv_paths = multiple_tsv_paths(contains(multiple_tsv_paths,sub.(ses{jj}){ii}));
        sub_tsv_paths
        
        tsv_path = sub_tsv_paths(contains(sub_tsv_paths,ses{jj}));
        for t = 1:length(tsv_path)
        assert(~isempty(tsv_path),sprintf('No %s file found for subject %s in seesion %s',tsv_path{t},sub.(ses{jj}){ii},ses{jj}));
        end
        
        tsv_path
        assert(length(tsv_path) == 1,sprintf('Found multiple %s files. If more than one modality is present with a %s file, this function must be updated',tsv_file,tsv_file));
        %path_split = cellfun(@(x) split(x,{'/'}),tsv_path,'UniformOutput',0);
        %modality=path_split{1}{end-1}
        
        
        var_names = readtable(tsv_path,'FileType','text').Properties.VariableNames;
        
        non_described_var_idx = ~ismember(var_names,described_vars);
        
        if any(non_described_var_idx)
            non_described_vars.(ses{jj}).(sub.(ses{jj}){ii}) = var_names(non_described_var_idx);
            fprintf('The file %s is missing a description for the ',tsv_path)
            fprintf('%s variable, ',non_described_vars.(ses{jj}).(sub.(ses{jj}){ii}){:})
            fprintf('for subject %s in session %s\n',sub.(ses{jj}){ii},ses{jj})
        end
    end
end

if ~exist('non_described_vars')
    non_described_vars = 'None';
end

end

